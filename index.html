<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NurseRoster Pro</title>

    <!-- Vite build bundle -->
    <script type="module" crossorigin src="/nurseroster/assets/index-Yk6DNFZR.js"></script>

    <!-- CSS chuẩn dùng trong khoa -->
    <style>
      body {
        font-family: Arial, Helvetica, sans-serif;
        margin: 20px;
        background: #f9fafb;
        color: #111;
      }

      h1, h2 {
        margin-bottom: 10px;
      }

      input[type="date"],
      input[type="text"],
      select {
        padding: 6px 8px;
        margin-bottom: 10px;
        font-size: 14px;
      }

      table {
        border-collapse: collapse;
        width: 100%;
        background: white;
        margin-top: 10px;
      }

      th, td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: left;
      }

      th {
        background: #f1f5f9;
        font-weight: bold;
      }

      tr:nth-child(even) {
        background: #f8fafc;
      }

      .legend {
        margin-top: 12px;
        font-size: 14px;
      }

      .legend-item {
        display: inline-block;
        margin-right: 15px;
      }

      .box {
        display: inline-block;
        width: 14px;
        height: 14px;
        margin-right: 5px;
        vertical-align: middle;
        border: 1px solid #999;
      }

      .weekend {
        background: #ef4444;
      }

      .holiday {
        background: #facc15;
      }

      .night {
        background: #a855f7;
      }

      @media (max-width: 600px) {
        body {
          margin: 10px;
          font-size: 14px;
        }

        table {
          font-size: 13px;
        }
      }
    </style>
  </head>

  <body>
    <!-- React mount -->
    <div id="root"></div>

    <!-- Legend (hiển thị luôn, React không cần biết) -->
    <div class="legend">
      <span class="legend-item">
        <span class="box weekend"></span> Cuối tuần
      </span>
      <span class="legend-item">
        <span class="box holiday"></span> Lễ
      </span>
      <span class="legend-item">
        <span class="box night"></span> Trực đêm (≥2 người)
      </span>
    </div>
    <script>
  // ====== CẤU HÌNH ======
  const HOLIDAYS = [
    "2026-01-01",
    "2026-04-30",
    "2026-05-01",
    "2026-09-02"
  ];

  // ====== HÀM TIỆN ÍCH ======
  function isWeekend(dateStr) {
    const d = new Date(dateStr);
    const day = d.getDay();
    return day === 0 || day === 6;
  }

  function isHoliday(dateStr) {
    return HOLIDAYS.includes(dateStr);
  }

  // ====== TÔ MÀU SAU KHI REACT RENDER ======
  function applyScheduleColors() {
    const rows = document.querySelectorAll("table tbody tr");

    rows.forEach(row => {
      const dateCell = row.children[0];
      if (!dateCell) return;

      const dateText = dateCell.textContent.trim();
      if (!dateText) return;

      // Chuẩn hoá yyyy-mm-dd
      const isoDate = dateText.includes("/")
        ? dateText.split("/").reverse().join("-")
        : dateText;

      // Cuối tuần
      if (isWeekend(isoDate)) {
        row.style.backgroundColor = "#fee2e2";
      }

      // Lễ
      if (isHoliday(isoDate)) {
        row.style.backgroundColor = "#fef9c3";
      }

      // Trực đêm ≥2 người
      const nurseCell = row.children[1];
      if (nurseCell) {
        const names = nurseCell.textContent.split(",");
        if (names.length >= 2) {
          nurseCell.style.backgroundColor = "#e9d5ff";
        }
      }
    });
  }

  // ====== CHỜ REACT LOAD XONG ======
  const observer = new MutationObserver(() => {
    const table = document.querySelector("table tbody");
    if (table && table.children.length > 0) {
      applyScheduleColors();
    }
  });

  observer.observe(document.getElementById("root"), {
    childList: true,
    subtree: true
  });
</script>

  </body>
</html>
